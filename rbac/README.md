# RBAC exercise

## Scenario One:
- We were asked to deploy a mysql instance that uses a secret named "database-access" to set credentials.
- User Dave (context=dave), as developer must be able only to manage deployments and pods in namespace "staging". To let him able to troubleshoot issues allow the capability to watch console output but __not exec into the pod__.
- User Bob (context=bob), as DBA must be the unique user who can view/manage secrent named "database-access" in namespaces "staging" and "production"
- A serviceaccount named "spinnaker" must be able to deploy the resources created by Dave and Bob in "production" namespace.

Questions:
1. Can we grant Dave permission to create secrets without expossing the dabase credentials?
2. Is database secret really secured in this scene?, what do we have to change to make it really secure?

Start creating the katakoda environment and in the controlplane node execute:
```
git clone https://github.com/davidp1404/k8s_playground.git
cd k8s_playground
./set-env.sh
source ~/.bashrc
cd rbac
./enable-token-auth.sh
echo "Wait till kubectl shows the node list"
watch -n 5 kubectl get nodes
```
Two kubeconfig contexts were created, you can move between them with kubectx passing as parameter the selected context name.
You can change your default namespace with:
```
controlplane $ kubectx
bob
dave
kubernetes-admin@kubernetes

controlplane $ k config set-context --current --namespace staging
```

<details close>
<summary> Solution</summary>
<br>
  
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
HyQ==IwEmS

Decrypt it at https://encipher.it
