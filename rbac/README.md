# RBAC exercise

## Scenario One:
- We were asked to deploy a mysql instance that uses a secret named "database-access" to set credentials.
- User Dave (context=dave), as developer must be able only to manage deployments and pods in namespace "staging". To let him able to troubleshoot issues allow the capability to watch console output but __not exec into the pod__.
- User Bob (context=bob), as DBA must be the unique user who can view/manage secrent named "database-access" in namespaces "staging" and "production"
- A serviceaccount named "spinnaker" must be able to deploy the resources created by Dave and Bob in "production" namespace.

Questions:
1. Can we grant Dave permission to create secrets without expossing the dabase credentials?
2. Is database secret really secured in this scene?, what do we have to change to make it really secure?

Start creating the katakoda environment and in the controlplane node execute:
```
git clone https://github.com/davidp1404/k8s_playground.git
cd k8s_playground
./set-env.sh
cd rbac
./enable-token-auth.sh
echo "Wait till kubectl shows the node list"
watch -n 5 kubectl get nodes
```
Two kubeconfig contexts were created, you can move between them with kubectx passing as parameter the selected context name.
You can change your default namespace with:
```
controlplane $ kubectx
bob
dave
kubernetes-admin@kubernetes

controlplane $ k config set-context --current --namespace staging
```

<details close>
<summary> Solution</summary>
<br>
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
0DleCJdYeIwEmS

Decrypt it at https://encipher.it
