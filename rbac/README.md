# RBAC exercise

## Scenario One:
- We were asked to deploy a mysql instance that uses a secret named "database-access" to set credentials.
- User Dave (context=dave), as developer must be able only to manage deployments and pods in namespace "staging". To let him able to troubleshoot issues allow the capability to watch console output but __not exec into the pod__.
- User Bob (context=bob), as DBA must be the unique user who can view/manage secrent named "database-access" in namespaces "staging" and "production"
- A serviceaccount named "spinnaker" must be able to deploy the resources created by Dave and Bob in "production" namespace.

Questions:
1. Can we grant Dave permission to create secrets without expossing the dabase credentials?
2. Is database secret really secured in this scene?, what do we have to change to make it really secure?

Start creating the katakoda environment and in the controlplane node execute:
```
git clone https://github.com/davidp1404/k8s_playground.git
cd k8s_playground
./set-env.sh
source ~/.bashrc
cd rbac
./enable-token-auth.sh
echo "Wait till kubectl shows the node list"
watch -n 5 kubectl get nodes
```
Two kubeconfig contexts were created, you can move between them with kubectx passing as parameter the selected context name.
You can change your default namespace with:
```
controlplane $ kubectx
bob
dave
kubernetes-admin@kubernetes

controlplane $ k config set-context --current --namespace staging
```

<details close>
<summary> Solution</summary>
<br>
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
hOgVn1w==IwEmS

Decrypt it at https://encipher.it
