# RBAC exercise

## Scenario One:
- We were asked to deploy a mysql instance that uses a secret named "database-access" to set credentials.
- User Dave (context=dave), as developer must be able only to manage deployments and pods in namespace "staging". To let him able to troubleshoot issues allow the capability to watch console output but __not exec into the pod__.
- User Bob (context=bob), as DBA must be the unique user who can view/manage secrent named "database-access" in namespaces "staging" and "production"
- A serviceaccount named "spinnaker" must be able to deploy the resources created by Dave and Bob in "production" namespace.

Questions:
1. Can we grant Dave permission to create secrets without expossing the dabase credentials?
2. Is database secret really secured in this scene?, what do we have to change to make it really secure?

Start creating the katakoda environment and in the controlplane node execute:
```
git clone https://github.com/davidp1404/k8s_playground.git
cd k8s_playground
./set-env.sh
source ~/.bashrc
cd rbac
./enable-token-auth.sh
echo "Wait till kubectl shows the node list"
watch -n 5 kubectl get nodes
```
Two kubeconfig contexts were created, you can move between them with kubectx passing as parameter the selected context name.
You can change your default namespace with:
```
controlplane $ kubectx
bob
dave
kubernetes-admin@kubernetes

controlplane $ k config set-context --current --namespace staging
```

<details close>
<summary> Solution</summary>
<br>
  
EnCt2516f1d5c02e643a85d27038ce62ad96f77b46650516f1d5c02e643a85d27038cflH75SnXmQP
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
P5vZxIwEmS

Decrypt it at https://encipher.it
